<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ æ‹¿å¤§28 åˆ†æå·¥å…· 2ä»£ - PC28 | Qç¾¤ï¼š1077134386 é£æœºï¼š@laomao12315</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            overflow-x: hidden;
        }

        /* å¯åŠ¨ç•Œé¢æ ·å¼ */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-y: auto;
            transition: opacity 0.5s ease-out;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .splash-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .splash-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* å¯åŠ¨ç•Œé¢æ»šåŠ¨æ¡æ ·å¼ */
        .splash-content::-webkit-scrollbar {
            width: 8px;
        }

        .splash-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .splash-content::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
        }

        .splash-content::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5568d3 0%, #653a8a 100%);
        }

        .splash-title {
            font-size: 28px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .splash-section {
            text-align: left;
            margin-bottom: 25px;
        }

        .splash-section h3 {
            font-size: 18px;
            color: #d00000;
            margin-bottom: 12px;
            font-weight: bold;
        }

        .splash-section p {
            font-size: 15px;
            line-height: 1.8;
            color: #333;
            margin-bottom: 10px;
        }

        .splash-section ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .splash-section li {
            font-size: 15px;
            line-height: 1.8;
            color: #333;
            margin-bottom: 8px;
        }

        .splash-section strong {
            color: #d00000;
            font-weight: bold;
        }

        .contact-info {
            background: #f0f5ff;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            margin: 20px 0;
        }

        .contact-info p {
            margin: 8px 0;
            font-weight: bold;
            color: #333;
        }

        .countdown-timer {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin: 25px 0;
            padding: 15px;
            background: #f0f5ff;
            border-radius: 10px;
        }

        .agree-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .agree-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .agree-button:active:not(:disabled) {
            transform: translateY(0);
        }

        .agree-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .main-content-wrapper {
            display: none;
        }

        .main-content-wrapper.show {
            display: block;
        }

        /* å¯åŠ¨ç•Œé¢å“åº”å¼ */
        @media (max-width: 768px) {
            .splash-content {
                padding: 25px 20px;
                border-radius: 15px;
            }

            .splash-title {
                font-size: 22px;
                margin-bottom: 20px;
            }

            .splash-section h3 {
                font-size: 16px;
            }

            .splash-section p,
            .splash-section li {
                font-size: 14px;
            }

            .countdown-timer {
                font-size: 20px;
                padding: 12px;
            }

            .agree-button {
                padding: 12px 40px;
                font-size: 16px;
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .splash-content {
                padding: 20px 15px;
            }

            .splash-title {
                font-size: 20px;
            }

            .splash-section {
                margin-bottom: 20px;
            }

            .contact-info {
                padding: 15px;
            }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        /* å€’è®¡æ—¶é¢æ¿ */
        .countdown-panel {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #667eea;
        }

        .big-timer {
            font-size: 72px;
            font-weight: bold;
            color: #d00000;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 12px;
            border: 3px solid #d00000;
            display: inline-block;
            min-width: 200px;
            transition: transform 0.3s;
        }

        .big-timer:hover {
            transform: scale(1.05);
        }

        .prev-summary {
            font-size: 16px;
            font-weight: bold;
            margin: 15px 0;
            color: #333;
        }

        .number-badge {
            display: inline-block;
            min-width: 28px;
            padding: 4px 8px;
            margin: 0 3px;
            background: #0078d4;
            color: white;
            border-radius: 6px;
            text-align: center;
            font-weight: bold;
        }

        .current-issue {
            font-size: 15px;
            font-weight: bold;
            margin: 10px 0;
            color: #333;
        }

        .predictions-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .prediction-box {
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            min-width: 220px;
            text-align: center;
            border: 2px solid;
            transition: all 0.3s;
            cursor: pointer;
        }

        .prediction-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .prediction-laomao {
            background: #fff5f5;
            border-color: #b21824;
            color: #b21824;
        }

        .prediction-kill2 {
            background: #fff8f0;
            border-color: #d35400;
            color: #d35400;
        }

        .prediction-ai {
            background: #f0f5ff;
            border-color: #335397;
            color: #335397;
        }

        .open-time {
            font-size: 13px;
            color: #666;
            font-weight: bold;
            margin-top: 10px;
        }

        /* é¡¶éƒ¨ä¿¡æ¯åŒº */
        .info-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            border-bottom: 2px solid #e0e0e0;
        }

        .info-item {
            font-size: 14px;
            font-weight: bold;
            color: #333;
        }

        .btn-refresh {
            background: #0078d4;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s;
            margin-left: auto;
        }

        .btn-refresh:hover {
            background: #005a9e;
            transform: scale(1.05);
        }

        .btn-refresh:active {
            transform: scale(0.95);
        }

        /* ä¸»è¦å†…å®¹åŒº */
        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            padding: 20px 30px;
        }

        @media (max-width: 1400px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            width: 100%;
            overflow: hidden; /* é˜²æ­¢å†…å®¹æº¢å‡º */
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }

        .scroll-hint {
            font-size: 12px;
            color: #666;
            font-weight: normal;
            margin-left: 10px;
            display: inline-block;
        }

        @media (max-width: 768px) {
            .scroll-hint {
                display: block;
                margin-left: 0;
                margin-top: 5px;
                font-size: 11px;
            }
        }

        /* è¡¨æ ¼æ ·å¼ */
        .table-container {
            overflow-x: auto;
            overflow-y: auto;
            max-height: 600px;
            width: 100%;
            position: relative;
            -webkit-overflow-scrolling: touch; /* ç§»åŠ¨ç«¯å¹³æ»‘æ»šåŠ¨ */
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }

        table {
            width: 100%;
            min-width: 1200px; /* è®¾ç½®æœ€å°å®½åº¦ï¼Œç¡®ä¿åœ¨å°å±å¹•ä¸Šå‡ºç°æ¨ªå‘æ»šåŠ¨æ¡ */
            border-collapse: collapse;
            font-size: 12px;
            background: white;
            table-layout: auto; /* è‡ªåŠ¨è°ƒæ•´åˆ—å®½ */
        }

        /* å“åº”å¼è¡¨æ ¼åˆ—å®½ */
        @media (max-width: 1600px) {
            table {
                min-width: 1100px;
            }
        }

        @media (max-width: 1400px) {
            table {
                min-width: 1000px;
            }
        }

        thead {
            position: sticky;
            top: 0;
            background: #667eea;
            color: white;
            z-index: 10;
        }

        th {
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        td {
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #ddd;
            font-weight: bold;
        }

        tbody tr:nth-child(even) {
            background: #f5f5f5;
        }

        tbody tr:hover {
            background: #e3f2fd;
            transform: scale(1.01);
            transition: all 0.2s;
        }

        .correct {
            color: #28a745;
            font-weight: bold;
        }

        .wrong {
            color: #dc3545;
            font-weight: bold;
        }

        .win-rate-high {
            color: #28a745;
            font-weight: bold;
        }

        .win-rate-low {
            color: #dc3545;
            font-weight: bold;
        }

        /* å›¾è¡¨å®¹å™¨ */
        .chart-container {
            position: relative;
            height: 400px;
            min-height: 300px;
            width: 100%;
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-sizing: border-box;
        }

        /* å“åº”å¼å›¾è¡¨é«˜åº¦ */
        @media (max-width: 1400px) {
            .chart-container {
                height: 450px;
            }
        }

        @media (max-width: 768px) {
            .chart-container {
                height: 350px;
                padding: 10px;
            }
        }

        @media (max-width: 480px) {
            .chart-container {
                height: 300px;
                padding: 8px;
            }
        }

        /* åº•éƒ¨ç»Ÿè®¡åŒº */
        .stats-section {
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 2px solid #e0e0e0;
        }

        .stats-item {
            font-size: 14px;
            font-weight: bold;
            margin: 8px 0;
            color: #333;
        }

        .stats-item.highlight {
            color: #b21824;
        }

        .stats-item.ai {
            color: #335397;
        }

        /* AIé…ç½®åŒº */
        .ai-config {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .ai-config label {
            font-size: 13px;
            font-weight: bold;
            color: #333;
        }

        .ai-config input {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 13px;
            min-width: 280px;
            transition: border-color 0.3s;
        }

        .ai-config input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-ai {
            background: #16a085;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 13px;
            transition: all 0.3s;
        }

        .btn-ai:hover {
            background: #13856e;
            transform: scale(1.05);
        }

        .btn-contact {
            background: #e67e22;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 13px;
            margin-top: 15px;
            transition: all 0.3s;
        }

        .btn-contact:hover {
            background: #d35400;
            transform: scale(1.05);
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .main-content {
                padding: 15px;
            }

            .section {
                padding: 15px;
            }

            .table-container {
                max-height: 500px;
            }

            table {
                min-width: 900px;
                font-size: 11px;
            }

            th, td {
                padding: 8px 6px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                border-radius: 12px;
            }

            .header {
                padding: 15px 20px;
            }

            .header h1 {
                font-size: 20px;
            }

            .countdown-panel {
                padding: 20px 15px;
            }

            .big-timer {
                font-size: 48px;
                padding: 15px;
                min-width: 150px;
            }

            .predictions-row {
                flex-direction: column;
                gap: 10px;
            }

            .prediction-box {
                width: 100%;
                min-width: auto;
            }

            .info-bar {
                padding: 12px 15px;
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .btn-refresh {
                margin-left: 0;
                width: 100%;
            }

            .main-content {
                padding: 10px;
                gap: 15px;
            }

            .section {
                padding: 12px;
            }

            .section-title {
                font-size: 16px;
            }

            .table-container {
                max-height: 400px;
                border-radius: 6px;
            }

            table {
                min-width: 800px;
                font-size: 10px;
            }

            th, td {
                padding: 6px 4px;
            }

            .stats-section {
                padding: 15px;
            }

            .stats-item {
                font-size: 12px;
            }

            .ai-config {
                flex-direction: column;
                align-items: stretch;
            }

            .ai-config input {
                width: 100%;
                min-width: auto;
            }

            .btn-ai, .btn-contact {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .big-timer {
                font-size: 36px;
            }

            table {
                min-width: 700px;
                font-size: 9px;
            }

            th, td {
                padding: 5px 3px;
            }

            .chart-container {
                height: 250px;
            }
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        .table-container::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        .table-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
            border: 1px solid #ddd;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 6px;
            border: 2px solid #f1f1f1;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5568d3 0%, #653a8a 100%);
        }

        .table-container::-webkit-scrollbar-corner {
            background: #f1f1f1;
        }

        /* Firefoxæ»šåŠ¨æ¡æ ·å¼ */
        .table-container {
            scrollbar-width: thin;
            scrollbar-color: #667eea #f1f1f1;
        }

        /* é”™è¯¯æç¤ºæ¡† */
        .error-alert {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 15px 30px;
            color: #856404;
            font-size: 13px;
            line-height: 1.6;
            display: none;
            position: relative;
        }

        .error-alert.show {
            display: block;
        }

        .error-alert strong {
            color: #d00000;
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .error-alert ul {
            margin: 8px 0 0 20px;
        }

        .error-alert li {
            margin: 4px 0;
        }

        .error-alert code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .error-alert .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ffc107;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 16px;
            line-height: 1;
            color: #856404;
            font-weight: bold;
        }

        .error-alert .close-btn:hover {
            background: #ffb300;
        }
    </style>
</head>
<body>
    <!-- å¯åŠ¨ç•Œé¢ -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-content">
            <div class="splash-title">âš ï¸ é‡è¦æç¤ºä¸å…è´£å£°æ˜</div>
            
            <div class="splash-section">
                <h3>ğŸ“‹ ä½¿ç”¨é¡»çŸ¥</h3>
                <p>æ¬¢è¿ä½¿ç”¨æœ¬æ•°æ®åˆ†æå·¥å…·ã€‚åœ¨ä½¿ç”¨å‰ï¼Œè¯·æ‚¨ä»”ç»†é˜…è¯»ä»¥ä¸‹å†…å®¹ï¼š</p>
                <ul>
                    <li>æœ¬å·¥å…·<strong>ä»…ç”¨äºæ•°æ®å±•ç¤ºå’Œèµ°åŠ¿åˆ†æ</strong>ï¼Œä¸æ¶‰åŠä»»ä½•å½¢å¼çš„æŠ•æ³¨ã€èµŒåšæˆ–è¿æ³•æ´»åŠ¨</li>
                    <li>æœ¬å·¥å…·<strong>ä¸æä¾›ä»»ä½•æŠ•æ³¨å»ºè®®</strong>ï¼Œä¹Ÿä¸ä¿è¯ä»»ä½•ç›ˆåˆ©</li>
                    <li>æœ¬å·¥å…·å±•ç¤ºçš„æ•°æ®ä»…ä¾›å‚è€ƒï¼Œ<strong>ä¸æ„æˆä»»ä½•æŠ•èµ„æˆ–æŠ•æ³¨å»ºè®®</strong></li>
                    <li>ä½¿ç”¨è€…éœ€<strong>è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨æœ¬å·¥å…·çš„ä¸€åˆ‡é£é™©</strong></li>
                </ul>
            </div>

            <div class="splash-section">
                <h3>ğŸš« ç¦æ­¢äº‹é¡¹</h3>
                <ul>
                    <li><strong>ä¸¥ç¦</strong>å°†æœ¬å·¥å…·ç”¨äºä»»ä½•å½¢å¼çš„èµŒåšã€æŠ•æ³¨æˆ–è¿æ³•æ´»åŠ¨</li>
                    <li><strong>ä¸¥ç¦</strong>åˆ©ç”¨æœ¬å·¥å…·è¿›è¡Œä»»ä½•è¿åæ³•å¾‹æ³•è§„çš„è¡Œä¸º</li>
                    <li><strong>ä¸¥ç¦</strong>å°†æœ¬å·¥å…·ç”¨äºä»»ä½•å¯èƒ½é€ æˆè´¢äº§æŸå¤±çš„æ´»åŠ¨</li>
                </ul>
            </div>

            <div class="splash-section">
                <h3>âš–ï¸ å…è´£å£°æ˜</h3>
                <p>æœ¬å·¥å…·ä»…ä½œä¸ºæ•°æ®åˆ†æå·¥å…·æä¾›ï¼Œå¼€å‘è€…ä¸å¯¹ä»¥ä¸‹æƒ…å†µæ‰¿æ‹…è´£ä»»ï¼š</p>
                <ul>
                    <li>å› ä½¿ç”¨æœ¬å·¥å…·è€Œäº§ç”Ÿçš„ä»»ä½•ç›´æ¥æˆ–é—´æ¥æŸå¤±</li>
                    <li>å› æ•°æ®å»¶è¿Ÿã€é”™è¯¯æˆ–ä¸å®Œæ•´å¯¼è‡´çš„ä»»ä½•åæœ</li>
                    <li>å› ä½¿ç”¨è€…è¿åæ³•å¾‹æ³•è§„ä½¿ç”¨æœ¬å·¥å…·è€Œäº§ç”Ÿçš„ä»»ä½•åæœ</li>
                    <li>å› ä½¿ç”¨è€…è¯¯ç”¨ã€æ»¥ç”¨æœ¬å·¥å…·è€Œäº§ç”Ÿçš„ä»»ä½•åæœ</li>
                </ul>
                <p><strong>ä½¿ç”¨æœ¬å·¥å…·å³è¡¨ç¤ºæ‚¨å·²å……åˆ†ç†è§£å¹¶åŒæ„æ‰¿æ‹…æ‰€æœ‰é£é™©å’Œè´£ä»»ã€‚</strong></p>
            </div>

            <div class="contact-info">
                <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ“ è”ç³»æ–¹å¼</h3>
                <p>Qç¾¤ï¼š1077134386</p>
                <p>Telegramï¼ˆé£æœºï¼‰ï¼š@laomao12315</p>
            </div>

            <div class="countdown-timer" id="countdownTimer">
                è¯·ä»”ç»†é˜…è¯»ä»¥ä¸Šå†…å®¹ï¼Œ<span id="countdownNumber">5</span> ç§’åå¯ç‚¹å‡»åŒæ„
            </div>

            <button class="agree-button" id="agreeButton" disabled onclick="agreeAndEnter()">
                æˆ‘åŒæ„å¹¶è¿›å…¥
            </button>
        </div>
    </div>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="main-content-wrapper" id="mainContentWrapper">
    <div class="container">
        <div class="header">
            <h1>åŠ æ‹¿å¤§28 åˆ†æå·¥å…· 2ä»£ - PC28</h1>
            <p style="font-size: 14px; opacity: 0.9;">Qç¾¤ï¼š1077134386 | é£æœºï¼š@laomao12315</p>
        </div>

        <!-- CORSé”™è¯¯æç¤º -->
        <div class="error-alert" id="errorAlert">
            <button class="close-btn" onclick="hideErrorAlert()" title="å…³é—­">Ã—</button>
            <strong>âš ï¸ APIè®¿é—®å¤±è´¥ï¼ˆCORSé™åˆ¶ï¼‰</strong>
            <div>è§£å†³æ–¹æ¡ˆï¼š</div>
            <ul>
                <li><strong>æ–¹æ³•1ï¼ˆæ¨èï¼‰ï¼š</strong>ä½¿ç”¨æœ¬åœ°HTTPæœåŠ¡å™¨è¿è¡Œæ­¤æ–‡ä»¶
                    <br>åœ¨æ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿è¡Œï¼š<code>python -m http.server 8000</code>
                    <br>ç„¶åè®¿é—®ï¼š<code>http://localhost:8000/2ä»£can2prosæ•´åˆ.html</code>
                </li>
                <li><strong>æ–¹æ³•2ï¼š</strong>å®‰è£…æµè§ˆå™¨æ‰©å±•ï¼ˆå¦‚"Allow CORS"æˆ–"CORS Unblock"ï¼‰</li>
                <li><strong>æ–¹æ³•3ï¼š</strong>ä½¿ç”¨Chromeå¯åŠ¨å‚æ•°ï¼ˆä»…ç”¨äºæµ‹è¯•ï¼‰
                    <br><code>chrome.exe --disable-web-security --user-data-dir="C:/temp/chrome_dev"</code>
                </li>
            </ul>
        </div>

        <!-- å€’è®¡æ—¶é¢æ¿ -->
        <div class="countdown-panel">
            <div class="big-timer" id="bigTimer">00:00</div>
            <div class="prev-summary" id="prevSummary">ä¸Šä¸€æœŸï¼š--</div>
            <div class="current-issue" id="currentIssue">æœ¬æœŸæœŸå·ï¼š--</div>
            <div class="predictions-row">
                <div class="prediction-box prediction-laomao" id="laomaoPred">è€çŒ«é¢„æµ‹ï¼š--</div>
                <div class="prediction-box prediction-kill2" id="kill2Pred">2å·é¢„æµ‹ï¼š--</div>
                <div class="prediction-box prediction-ai" id="aiPredTop">AIé¢„æµ‹ï¼š--</div>
            </div>
            <div class="open-time" id="openTime">é¢„è®¡å¼€å¥–æ—¶é—´ï¼š--</div>
        </div>

        <!-- é¡¶éƒ¨ä¿¡æ¯åŒº -->
        <div class="info-bar">
            <div class="info-item" id="currentSection">å½“å‰æœŸæ•°ï¼š--</div>
            <div class="info-item" id="nextSection">ä¸‹ä¸€æœŸï¼š--</div>
            <div class="info-item" id="remainingTime">æœ¬æœŸå‰©ä½™æ—¶é—´ï¼š--:--</div>
            <div class="info-item" id="serverDjs">æœåŠ¡å™¨å€’è®¡æ—¶ï¼š-- ç§’</div>
            <button class="btn-refresh" onclick="manualRefresh()">ç«‹å³åˆ·æ–°</button>
        </div>

        <!-- ä¸»è¦å†…å®¹åŒº -->
        <div class="main-content">
            <!-- å†å²è®°å½•è¡¨æ ¼ -->
            <div class="section">
                <div class="section-title">å†å²è®°å½•ï¼ˆæœ€æ–° 50 æœŸï¼‰<span class="scroll-hint">â† å·¦å³æ»‘åŠ¨æŸ¥çœ‹æ›´å¤šåˆ— â†’</span></div>
                <div class="table-container">
                    <table id="historyTable">
                        <thead>
                            <tr>
                                <th>æœŸå·</th>
                                <th>æ—¶é—´</th>
                                <th>å·ç 1</th>
                                <th>å·ç 2</th>
                                <th>å·ç 3</th>
                                <th>å’Œå€¼</th>
                                <th>å¤§å°å•åŒ</th>
                                <th>è€çŒ«é¢„æµ‹å¯¹é”™</th>
                                <th>2å·æ€ç»„å¯¹é”™</th>
                                <th>AIé¢„æµ‹å¯¹é”™</th>
                                <th>è€çŒ«20æœŸèƒœç‡</th>
                                <th>2å·20æœŸèƒœç‡</th>
                                <th>AI20æœŸèƒœç‡</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <tr><td colspan="13" style="text-align: center; padding: 20px;">åŠ è½½ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- èµ°åŠ¿å›¾ -->
            <div class="section">
                <div class="section-title">èµ°åŠ¿å›¾</div>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
        </div>

        <!-- åº•éƒ¨ç»Ÿè®¡åŒº -->
        <div class="stats-section">
            <div class="section-title">æ•°æ®åˆ†æ</div>
            <div class="stats-item" id="statsMain">æœ€è¿‘ 0 æœŸç»Ÿè®¡ï¼šå¤§ 0  å° 0  å• 0  åŒ 0</div>
            <div class="stats-item" id="streakInfo">è¿å¼€æƒ…å†µï¼š--</div>
            <div class="stats-item highlight" id="predictInfo">é¢„æµ‹ï¼š--</div>
            
            <!-- AIé…ç½® -->
            <div class="ai-config">
                <label>DeepSeek Tokenï¼š</label>
                <input type="password" id="tokenInput" placeholder="åœ¨æ­¤è¾“å…¥ DeepSeek API Token">
                <button class="btn-ai" onclick="runAiPredict()">AI é¢„æµ‹å½“å‰æœŸ</button>
            </div>
            
            <div class="stats-item ai" id="aiPredict">AI é¢„æµ‹ï¼š--</div>
            <button class="btn-contact" onclick="showContact()">è”ç³»æ–¹å¼ / å…è´£å£°æ˜</button>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        const BASE_URL = "https://pc28yb.com/";
        let latestRecords = [];
        let aiPredictionsByIssue = {};
        let currentSection = "";
        let nextSection = "";
        let remainingSeconds = 0;
        let serverDjsSeconds = 0;
        let trendChart = null;
        const PERIOD_SECONDS = 210;

        // åˆå§‹åŒ–ä¸»å†…å®¹ï¼ˆåªåœ¨ç”¨æˆ·åŒæ„åæ‰§è¡Œï¼‰
        function initMainContent() {
            // åŠ è½½ä¿å­˜çš„Token
            loadDeepSeekToken();
            
            // åˆå§‹åŒ–å›¾è¡¨
            initChart();
            
            // é¦–æ¬¡åŠ è½½æ•°æ®
            autoRefreshFromServer();
            
            // å¯åŠ¨å®šæ—¶å™¨
            setInterval(onTimerTick, 1000);
            
            // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°è°ƒæ•´å›¾è¡¨
            let resizeTimer;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(function() {
                    if (trendChart) {
                        trendChart.resize();
                    }
                }, 250);
            });
        }

        // å·¥å…·å‡½æ•°
        function formatTime(seconds) {
            const m = Math.max(0, Math.floor(seconds / 60));
            const s = Math.max(0, seconds % 60);
            return `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
        }

        // CORSä»£ç†é…ç½® - ä½¿ç”¨å¤šä¸ªä»£ç†æœåŠ¡ä½œä¸ºå¤‡é€‰
        const CORS_PROXIES = [
            'https://api.allorigins.win/raw?url=',
            'https://corsproxy.io/?',
            'https://api.codetabs.com/v1/proxy?quest='
        ];
        let currentProxyIndex = 0;
        
        // APIè°ƒç”¨ï¼ˆè‡ªåŠ¨å°è¯•å¤šä¸ªCORSä»£ç†ï¼‰
        async function apiGet(path, params = {}, asJson = false) {
            const url = new URL(path, BASE_URL);
            Object.keys(params).forEach(key => url.searchParams.append(key, params[key]));
            const targetUrl = url.toString();
            
            // é¦–å…ˆå°è¯•ç›´æ¥è®¿é—®
            try {
                const response = await fetch(targetUrl, {
                    method: 'GET',
                    mode: 'cors',
                    cache: 'no-cache',
                    headers: {
                        'Accept': asJson ? 'application/json' : 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
                    }
                });
                
                if (response.ok) {
                    return asJson ? await response.json() : await response.text();
                }
            } catch (directError) {
                console.log('ç›´æ¥è®¿é—®å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨CORSä»£ç†...', directError.message);
            }
            
            // å¦‚æœç›´æ¥è®¿é—®å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨CORSä»£ç†
            let lastError = null;
            for (let i = 0; i < CORS_PROXIES.length; i++) {
                const proxyIndex = (currentProxyIndex + i) % CORS_PROXIES.length;
                const proxyUrl = CORS_PROXIES[proxyIndex] + encodeURIComponent(targetUrl);
                
                try {
                    const response = await fetch(proxyUrl, {
                        method: 'GET',
                        mode: 'cors',
                        cache: 'no-cache'
                    });
                    
                    if (response.ok) {
                        currentProxyIndex = proxyIndex; // è®°ä½æˆåŠŸçš„ä»£ç†
                        const result = await response.text();
                        
                        // å¦‚æœæ˜¯JSONï¼Œå°è¯•è§£æ
                        if (asJson) {
                            try {
                                return JSON.parse(result);
                            } catch (e) {
                                // å¦‚æœè§£æå¤±è´¥ï¼Œå¯èƒ½ä»£ç†è¿”å›äº†åŒ…è£…çš„JSON
                                const jsonMatch = result.match(/\{[\s\S]*\}/);
                                if (jsonMatch) {
                                    return JSON.parse(jsonMatch[0]);
                                }
                                throw new Error('æ— æ³•è§£æJSONå“åº”');
                            }
                        }
                        return result;
                    }
                } catch (proxyError) {
                    console.log(`ä»£ç† ${proxyIndex + 1} å¤±è´¥:`, proxyError.message);
                    lastError = proxyError;
                    continue;
                }
            }
            
            // æ‰€æœ‰æ–¹æ³•éƒ½å¤±è´¥
            const errorMsg = 'APIè®¿é—®å¤±è´¥ï¼šCORSé™åˆ¶ã€‚è§£å†³æ–¹æ¡ˆï¼š\n' +
                '1. å®‰è£…æµè§ˆå™¨æ‰©å±•ï¼ˆå¦‚CORS Unblockï¼‰\n' +
                '2. ä½¿ç”¨æœ¬åœ°HTTPæœåŠ¡å™¨è¿è¡Œï¼ˆå¦‚ï¼špython -m http.serverï¼‰\n' +
                '3. ä½¿ç”¨Chromeå¯åŠ¨å‚æ•°ï¼š--disable-web-security --user-data-dir="C:/temp/chrome_dev"';
            throw new Error(errorMsg);
        }

        async function getNextInfo() {
            return await apiGet("index.php", {gameType: "jnd28", action: "next"}, true);
        }

        async function getGuessJson() {
            const text = await apiGet("index.php", {action: "getMyOpensJson"});
            return JSON.parse(text);
        }

        async function getShazuPredictions() {
            const predictions = {};
            try {
                const targetUrl = "http://www.xyyc28.top/jnd/jndsz.php";
                let html = '';
                
                // å°è¯•ç›´æ¥è®¿é—®
                try {
                    const response = await fetch(targetUrl, {
                        method: 'GET',
                        mode: 'cors',
                        cache: 'no-cache'
                    });
                    if (response.ok) {
                        html = await response.text();
                    } else {
                        throw new Error('Direct fetch failed');
                    }
                } catch (directError) {
                    // ä½¿ç”¨CORSä»£ç†
                    const proxyUrl = CORS_PROXIES[currentProxyIndex] + encodeURIComponent(targetUrl);
                    const response = await fetch(proxyUrl, {
                        method: 'GET',
                        mode: 'cors',
                        cache: 'no-cache'
                    });
                    if (response.ok) {
                        html = await response.text();
                    } else {
                        throw new Error('Proxy fetch failed');
                    }
                }
                
                // ç®€å•çš„HTMLè§£æï¼ˆå¦‚æœéœ€è¦æ›´å¤æ‚å¯ä»¥ç”¨DOMParserï¼‰
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const tbody = doc.querySelector('tbody#biaoge') || doc.querySelector('tbody');
                
                if (tbody) {
                    const rows = tbody.querySelectorAll('tr');
                    rows.forEach(tr => {
                        const tds = tr.querySelectorAll('td');
                        if (tds.length >= 5) {
                            const section = tds[0].textContent.trim();
                            const predTd = tds[3];
                            const fonts = predTd.querySelectorAll('font');
                            let predDisplay = "";
                            if (fonts.length >= 2) {
                                predDisplay = `${fonts[0].textContent.trim()} + ${fonts[1].textContent.trim()}`;
                            } else {
                                predDisplay = predTd.textContent.trim();
                            }
                            
                            const resultTd = tds[4];
                            const resultText = resultTd.textContent.trim();
                            let result = "";
                            if (resultText.includes("æ­£ç¡®")) {
                                result = "å¯¹";
                            } else if (resultText.includes("é”™è¯¯")) {
                                result = "é”™";
                            }
                            
                            predictions[section] = [predDisplay, result];
                        }
                    });
                }
            } catch (error) {
                console.error('è·å–2å·é¢„æµ‹å¤±è´¥:', error);
            }
            return predictions;
        }

        // æ•°æ®ç±»
        class OpenRecord {
            constructor(section, openCodes, openTime) {
                this.section = section;
                this.openCodes = openCodes;
                this.openTime = openTime;
            }

            get total() {
                return this.openCodes.slice(0, 3).reduce((a, b) => a + b, 0);
            }

            get da_xiao() {
                return this.total >= 14 ? "å¤§" : "å°";
            }

            get dan_shuang() {
                return this.total % 2 === 1 ? "å•" : "åŒ";
            }
        }

        // é¢„æµ‹æ ¼å¼åŒ–
        function formatPredictionDisplay(prediction) {
            if (!prediction || prediction === "æœªçŸ¥" || prediction === "è·å–ä¸­...") {
                return prediction;
            }
            
            if (prediction.includes("+")) {
                const parts = prediction.split("+");
                if (parts.length === 2) {
                    const part1 = parts[0].trim();
                    const part2 = parts[1].trim();
                    
                    if (part2.length === 2 && ["å¤§", "å°"].includes(part2[0]) && ["å•", "åŒ"].includes(part2[1])) {
                        const dx2 = part2[0];
                        const ds2 = part2[1];
                        let resultList = [];
                        
                        if (part1 === "å¤§") {
                            resultList = ["å¤§å•", "å¤§åŒ"];
                        } else if (part1 === "å°") {
                            resultList = ["å°åŒ", "å°å•"];
                        } else if (part1 === "å•") {
                            resultList = ["å¤§å•", "å°å•"];
                        } else if (part1 === "åŒ") {
                            resultList = ["å¤§åŒ", "å°åŒ"];
                        }
                        
                        if (!resultList.includes(part2)) {
                            resultList.push(part2);
                        }
                        
                        return resultList.join("");
                    }
                }
                return prediction;
            }
            
            const mapping = {
                "å¤§å•": "å¤§å•å¤§åŒå°å•",
                "å¤§åŒ": "å¤§å•å¤§åŒå°åŒ",
                "å°å•": "å¤§å•å°å•å°åŒ",
                "å°åŒ": "å¤§åŒå°å•å°åŒ"
            };
            
            return mapping[prediction] || prediction;
        }

        // è®¡ç®—èƒœç‡
        function calculateWinRate(records, predictResultBySection, shazuPredictions, aiPredictions, modelType, startIndex, periodCount = 20) {
            if (startIndex >= records.length) return "--";
            
            const endIndex = Math.min(records.length, startIndex + periodCount);
            const targetRecords = records.slice(startIndex, endIndex);
            
            if (targetRecords.length === 0) return "--";
            
            let correctCount = 0;
            let totalCount = 0;
            
            for (const r of targetRecords) {
                if (modelType === "laomao") {
                    const hit = predictResultBySection[r.section];
                    if (hit) {
                        totalCount++;
                        if (hit === "å¯¹") correctCount++;
                    }
                } else if (modelType === "kill2") {
                    if (r.section in shazuPredictions) {
                        const [, kill2Hit] = shazuPredictions[r.section];
                        if (kill2Hit) {
                            totalCount++;
                            if (kill2Hit === "å¯¹") correctCount++;
                        }
                    }
                } else if (modelType === "ai") {
                    const aiCombo = aiPredictions[r.section];
                    if (aiCombo) {
                        const aiDx = aiCombo[0] && ["å¤§", "å°"].includes(aiCombo[0]) ? aiCombo[0] : "";
                        const aiDs = aiCombo.length > 1 && ["å•", "åŒ"].includes(aiCombo[1]) ? aiCombo[1] : "";
                        if (aiDx || aiDs) {
                            totalCount++;
                            const correct = (aiDx === r.da_xiao) || (aiDs === r.dan_shuang);
                            if (correct) correctCount++;
                        }
                    }
                }
            }
            
            if (totalCount === 0) return "--";
            
            const winRate = (correctCount / totalCount) * 100;
            return `${winRate.toFixed(1)}%`;
        }

        // è‡ªåŠ¨åˆ·æ–°
        async function autoRefreshFromServer() {
            try {
                // éšè—ä¹‹å‰çš„é”™è¯¯æç¤º
                hideErrorAlert();
                
                const nextInfo = await getNextInfo();
                const nextSec = String(nextInfo.section || "");
                const djs = parseInt(nextInfo.djs || PERIOD_SECONDS);
                
                let cur = "--";
                try {
                    cur = String(parseInt(nextSec) - 1);
                } catch (e) {}
                
                currentSection = cur;
                nextSection = nextSec;
                remainingSeconds = djs;
                serverDjsSeconds = djs;
                
                document.getElementById('currentSection').textContent = `å½“å‰æœŸæ•°ï¼š${cur}`;
                document.getElementById('nextSection').textContent = `ä¸‹ä¸€æœŸï¼š${nextSec}`;
                document.getElementById('currentIssue').textContent = `æœ¬æœŸæœŸå·ï¼š${nextSec}`;
                
                const eta = new Date(Date.now() + djs * 1000);
                document.getElementById('openTime').textContent = 
                    `é¢„è®¡å¼€å¥–æ—¶é—´ï¼š${eta.toLocaleString('zh-CN', {year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit'})}`;
                
                document.getElementById('serverDjs').textContent = `æœåŠ¡å™¨å€’è®¡æ—¶ï¼š${djs} ç§’`;
                updateRemainingLabel();
                
                await loadHistoryAndStatistics();
                
                // å¦‚æœå·²é…ç½®Tokenï¼Œè‡ªåŠ¨è¿›è¡ŒAIé¢„æµ‹
                const token = localStorage.getItem('deepseek_token');
                if (token) {
                    runAiPredict(true);
                }
            } catch (error) {
                console.error('è·å–ä¸‹ä¸€æœŸä¿¡æ¯å¤±è´¥:', error);
                // æ˜¾ç¤ºé”™è¯¯æç¤ºæ¡†
                const errorAlert = document.getElementById('errorAlert');
                if (errorAlert) {
                    errorAlert.classList.add('show');
                }
                // ä¹Ÿæ˜¾ç¤ºalertä»¥ä¾¿ç”¨æˆ·ç«‹å³çœ‹åˆ°
                if (error.message.includes('CORS') || error.message.includes('Failed to fetch')) {
                    // CORSé”™è¯¯å·²ç»åœ¨æç¤ºæ¡†ä¸­è¯´æ˜äº†ï¼Œä¸éœ€è¦é‡å¤alert
                } else {
                    alert(`è·å–ä¸‹ä¸€æœŸä¿¡æ¯å¤±è´¥ï¼š\n${error.message}`);
                }
            }
        }
        
        // éšè—é”™è¯¯æç¤ºæ¡†
        function hideErrorAlert() {
            const errorAlert = document.getElementById('errorAlert');
            if (errorAlert) {
                errorAlert.classList.remove('show');
            }
        }

        async function loadHistoryAndStatistics() {
            try {
                const raw = await getGuessJson();
                const data = raw.data || [];
                const records = [];
                
                for (const item of data.slice(0, 50)) {
                    const codes = [];
                    for (let i = 1; i <= 10; i++) {
                        const key = `openCode${i}`;
                        try {
                            codes.push(parseInt(item[key] || "0"));
                        } catch (e) {
                            codes.push(0);
                        }
                    }
                    records.push(new OpenRecord(
                        String(item.section || ""),
                        codes,
                        String(item.openTime || "")
                    ));
                }
                
                latestRecords = records;
                
                // è®¡ç®—è€çŒ«é¢„æµ‹å¯¹é”™
                const orderedOldToNew = [...records].sort((a, b) => a.openTime.localeCompare(b.openTime));
                const predictResultBySection = {};
                
                for (let i = 0; i < orderedOldToNew.length - 1; i++) {
                    const base = orderedOldToNew[i];
                    const target = orderedOldToNew[i + 1];
                    
                    if (base.openCodes.length < 3 || target.openCodes.length < 3) continue;
                    
                    const n1 = base.openCodes[0];
                    const n2 = base.openCodes[1];
                    const n3 = base.openCodes[2];
                    const guessDx = (n2 + n3) > 13 ? "å¤§" : "å°";
                    const guessDs = (n1 + n2) % 2 === 1 ? "å•" : "åŒ";
                    
                    const correct = (guessDx === target.da_xiao) || (guessDs === target.dan_shuang);
                    predictResultBySection[target.section] = correct ? "å¯¹" : "é”™";
                }
                
                // æŒ‰æ—¶é—´å€’åº
                const sortedByTime = [...records].sort((a, b) => b.openTime.localeCompare(a.openTime));
                
                // æ›´æ–°ä¸Šä¸€æœŸä¿¡æ¯
                if (sortedByTime.length > 0) {
                    const last = sortedByTime[0];
                    const combo = `${last.da_xiao}${last.dan_shuang}`;
                    const numsHtml = last.openCodes.slice(0, 3).map(n => 
                        `<span class="number-badge">${n}</span>`
                    ).join("");
                    document.getElementById('prevSummary').innerHTML = 
                        `ä¸Šä¸€æœŸï¼š${last.section}  ${numsHtml}  <span style="color:#d00000;font-weight:bold;">${combo}</span>`;
                    
                    updatePrediction(last);
                }
                
                // è·å–2å·é¢„æµ‹
                const shazuPredictions = await getShazuPredictions();
                
                // æ›´æ–°è¡¨æ ¼
                populateTable(sortedByTime, predictResultBySection, shazuPredictions);
                
                // æ›´æ–°èµ°åŠ¿å›¾
                updateTrendChart(records.slice(0, 30));
                
                // æ›´æ–°ç»Ÿè®¡
                updateStatistics(records);
            } catch (error) {
                console.error('è·å–å†å²æ•°æ®å¤±è´¥:', error);
                alert(`è·å–å†å²æ•°æ®å¤±è´¥ï¼š\n${error.message}`);
            }
        }

        function populateTable(records, predictResultBySection, shazuPredictions = {}) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = "";
            
            for (let row = 0; row < records.length; row++) {
                const r = records[row];
                const combo = `${r.da_xiao}${r.dan_shuang}`;
                const hit = predictResultBySection[r.section] || "";
                
                let kill2Hit = "";
                if (r.section in shazuPredictions) {
                    [, kill2Hit] = shazuPredictions[r.section];
                }
                
                let aiHit = "";
                const aiCombo = aiPredictionsByIssue[r.section];
                if (aiCombo) {
                    const aiDx = aiCombo[0] && ["å¤§", "å°"].includes(aiCombo[0]) ? aiCombo[0] : "";
                    const aiDs = aiCombo.length > 1 && ["å•", "åŒ"].includes(aiCombo[1]) ? aiCombo[1] : "";
                    if (aiDx || aiDs) {
                        const correct = (aiDx === r.da_xiao) || (aiDs === r.dan_shuang);
                        aiHit = correct ? "å¯¹" : "é”™";
                    }
                }
                
                const laomaoRate = calculateWinRate(records, predictResultBySection, shazuPredictions, aiPredictionsByIssue, "laomao", row, 20);
                const kill2Rate = calculateWinRate(records, predictResultBySection, shazuPredictions, aiPredictionsByIssue, "kill2", row, 20);
                const aiRate = calculateWinRate(records, predictResultBySection, shazuPredictions, aiPredictionsByIssue, "ai", row, 20);
                
                const tr = document.createElement('tr');
                const values = [
                    r.section,
                    r.openTime,
                    String(r.openCodes[0]),
                    String(r.openCodes[1]),
                    String(r.openCodes[2]),
                    String(r.total),
                    combo,
                    hit,
                    kill2Hit,
                    aiHit,
                    laomaoRate,
                    kill2Rate,
                    aiRate
                ];
                
                values.forEach((v, col) => {
                    const td = document.createElement('td');
                    td.textContent = v;
                    
                    if (col === 7 || col === 8 || col === 9) {
                        if (v === "å¯¹") {
                            td.className = "correct";
                        } else if (v === "é”™") {
                            td.className = "wrong";
                        }
                    } else if (col === 10 || col === 11 || col === 12) {
                        if (v !== "--") {
                            try {
                                const rateValue = parseFloat(v.replace("%", ""));
                                if (rateValue >= 50) {
                                    td.className = "win-rate-high";
                                } else {
                                    td.className = "win-rate-low";
                                }
                            } catch (e) {}
                        }
                    }
                    
                    tr.appendChild(td);
                });
                
                tbody.appendChild(tr);
            }
        }

        function updateStatistics(records) {
            if (records.length === 0) {
                document.getElementById('statsMain').textContent = "æœ€è¿‘ 0 æœŸç»Ÿè®¡ï¼šå¤§ 0  å° 0  å• 0  åŒ 0";
                document.getElementById('streakInfo').textContent = "è¿å¼€æƒ…å†µï¼š--";
                return;
            }
            
            let stats = {å¤§: 0, å°: 0, å•: 0, åŒ: 0};
            records.forEach(r => {
                stats[r.da_xiao]++;
                stats[r.dan_shuang]++;
            });
            
            document.getElementById('statsMain').textContent = 
                `æœ€è¿‘ ${records.length} æœŸç»Ÿè®¡ï¼šå¤§ ${stats.å¤§}  å° ${stats.å°}  å• ${stats.å•}  åŒ ${stats.åŒ}`;
            
            const last = records[0];
            const lastDx = last.da_xiao;
            const lastDs = last.dan_shuang;
            
            let streakDx = 0;
            let streakDs = 0;
            
            for (const r of records) {
                if (r.da_xiao === lastDx) {
                    streakDx++;
                } else {
                    break;
                }
            }
            
            for (const r of records) {
                if (r.dan_shuang === lastDs) {
                    streakDs++;
                } else {
                    break;
                }
            }
            
            document.getElementById('streakInfo').textContent = 
                `è¿å¼€æƒ…å†µï¼šæœ€è¿‘ ${streakDx} æœŸéƒ½æ˜¯ã€Œ${lastDx}ã€ï¼Œæœ€è¿‘ ${streakDs} æœŸéƒ½æ˜¯ã€Œ${lastDs}ã€`;
        }

        function updatePrediction(last) {
            if (last.openCodes.length < 3) {
                document.getElementById('predictInfo').textContent = "é¢„æµ‹ï¼šæ•°æ®ä¸è¶³";
                document.getElementById('laomaoPred').textContent = "è€çŒ«é¢„æµ‹ï¼šæ•°æ®ä¸è¶³";
                document.getElementById('kill2Pred').textContent = "2å·é¢„æµ‹ï¼šæ•°æ®ä¸è¶³";
                return;
            }
            
            const n1 = last.openCodes[0];
            const n2 = last.openCodes[1];
            const n3 = last.openCodes[2];
            
            const guessDx = (n2 + n3) > 13 ? "å¤§" : "å°";
            const guessDs = (n1 + n2) % 2 === 1 ? "å•" : "åŒ";
            
            const combo = guessDx + guessDs;
            const killCombo = (guessDx === "å¤§" ? "å°" : "å¤§") + (guessDs === "å•" ? "åŒ" : "å•");
            
            let nextSec = "æœªçŸ¥";
            try {
                nextSec = String(parseInt(last.section) + 1);
            } catch (e) {}
            
            // è·å–2å·é¢„æµ‹
            getShazuPredictions().then(shazuPredictions => {
                let killDisplay2 = "è·å–ä¸­...";
                if (nextSec in shazuPredictions) {
                    [killDisplay2] = shazuPredictions[nextSec];
                }
                
                document.getElementById('predictInfo').textContent = 
                    `é¢„æµ‹ä¸‹ä¸€æœŸï¼ˆ${nextSec}ï¼‰ï¼šç»„åˆ ${combo}ï¼Œæ€ç»„ ${killCombo}ï¼Œå¤§å° ${guessDx}ï¼Œå•åŒ ${guessDs}    |    2å·é¢„æµ‹ï¼š${killDisplay2}`;
                
                const laomaoDisplay = formatPredictionDisplay(combo);
                document.getElementById('laomaoPred').textContent = `è€çŒ«é¢„æµ‹ï¼š${laomaoDisplay}`;
                
                const kill2Display = formatPredictionDisplay(killDisplay2);
                document.getElementById('kill2Pred').textContent = `2å·é¢„æµ‹ï¼š${kill2Display}`;
            });
        }

        // å›¾è¡¨åˆå§‹åŒ–
        function initChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'å’Œå€¼',
                        data: [],
                        borderColor: '#0078d4',
                        backgroundColor: 'rgba(0, 120, 212, 0.1)',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#0078d4',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    resizeDelay: 0,
                    plugins: {
                        title: {
                            display: true,
                            text: 'å’Œå€¼èµ°åŠ¿',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        },
                        tooltip: {
                            enabled: true,
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: -1,
                            max: 28,
                            title: {
                                display: true,
                                text: 'å’Œå€¼',
                                font: {
                                    size: 12
                                }
                            },
                            ticks: {
                                font: {
                                    size: 11
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'æœŸæ•°ï¼ˆä»æ—§åˆ°æ–°ï¼‰',
                                font: {
                                    size: 12
                                }
                            },
                            ticks: {
                                font: {
                                    size: 11
                                },
                                maxRotation: 45,
                                minRotation: 0
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        function updateTrendChart(records) {
            if (!trendChart || records.length === 0) return;
            
            const ordered = [...records].reverse();
            const totals = ordered.map(r => r.total);
            const labels = ordered.map((r, i) => i + 1);
            
            trendChart.data.labels = labels;
            trendChart.data.datasets[0].data = totals;
            trendChart.update();
        }

        // å®šæ—¶å™¨
        function updateRemainingLabel() {
            const text = formatTime(remainingSeconds);
            document.getElementById('remainingTime').textContent = `æœ¬æœŸå‰©ä½™æ—¶é—´ï¼š${text}`;
            document.getElementById('bigTimer').textContent = text;
        }

        function onTimerTick() {
            if (remainingSeconds > 0) {
                remainingSeconds--;
            }
            updateRemainingLabel();
            
            if (serverDjsSeconds > 0) {
                serverDjsSeconds--;
            }
            document.getElementById('serverDjs').textContent = `æœåŠ¡å™¨å€’è®¡æ—¶ï¼š${Math.max(serverDjsSeconds, 0)} ç§’`;
            
            if (remainingSeconds <= 0) {
                autoRefreshFromServer();
            }
        }

        // æ‰‹åŠ¨åˆ·æ–°
        function manualRefresh() {
            autoRefreshFromServer();
        }

        // AIé¢„æµ‹
        async function runAiPredict(auto = false) {
            const tokenInput = document.getElementById('tokenInput');
            const token = tokenInput.value.trim();
            
            if (!token) {
                if (!auto) {
                    alert("è¯·å…ˆåœ¨ä¸‹æ–¹è¾“å…¥ DeepSeek API Tokenã€‚");
                }
                return;
            }
            
            // ä¿å­˜Token
            localStorage.setItem('deepseek_token', token);
            
            if (!latestRecords.length || !nextSection) {
                if (!auto) {
                    alert("æš‚æ— å†å²æ•°æ®ï¼Œæ— æ³•è¿›è¡Œ AI é¢„æµ‹ã€‚");
                }
                return;
            }
            
            const N = 20;
            const ordered = [...latestRecords].sort((a, b) => b.openTime.localeCompare(a.openTime));
            const contextRecords = ordered.slice(0, N);
            
            const historyLines = contextRecords.map(r => 
                `æœŸå· ${r.section} å’Œå€¼ ${r.total} å¤§å° ${r.da_xiao} å•åŒ ${r.dan_shuang}`
            );
            const historyText = historyLines.join("\n");
            
            const prompt = `ä½ æ˜¯ä¸€ä¸ªåªåšæ•°æ®ç»Ÿè®¡å’Œæ¨¡å¼åˆ†æçš„åŠ©æ‰‹ï¼Œä¸“é—¨åˆ†æåŠ æ‹¿å¤§28ï¼ˆPC28ï¼‰å†å²å¼€å¥–ç»“æœçš„èµ°åŠ¿ï¼Œæ ¹æ®æœ€è¿‘çš„å†å²æ•°æ®ï¼Œé¢„æµ‹**ä¸‹ä¸€æœŸ**çš„å¤§å°å•åŒã€‚

æ³¨æ„ï¼šä¸‹é¢çš„å†å²æ•°æ®**ç¬¬ä¸€è¡Œæ˜¯æœ€æ–°ä¸€æœŸ**ï¼Œå¾€ä¸‹è¶Šæ—§ï¼Œåªçœ‹è¿™äº›æ•°æ®æ¥åšåˆ¤æ–­ã€‚
å†å²æ•°æ®æ ¼å¼ï¼šæœŸå· å’Œå€¼ å¤§å° å•åŒã€‚
ä»¥ä¸‹æ˜¯æœ€è¿‘çš„å†å²æ•°æ®ï¼ˆä»æ–°åˆ°æ—§ï¼‰ï¼š
${historyText}

ç°åœ¨è¦é¢„æµ‹çš„æœŸå·æ˜¯ï¼š${nextSection}ã€‚
è¯·åªåŸºäºä¸Šé¢è¿™äº›æœ€è¿‘æ•°æ®ç»™å‡ºä¸€ä¸ªå®¢è§‚çš„æ¨æµ‹ç»“æœï¼Œå¹¶ä¸”ä¸¥æ ¼åªè¾“å‡ºä»¥ä¸‹ 4 ä¸ªç»“æœä¹‹ä¸€ï¼šå¤§å•ã€å¤§åŒã€å°å•ã€å°åŒã€‚
ä¸è¦è¾“å‡ºå…¶ä»–ä»»ä½•æ–‡å­—ã€‚`;
            
            try {
                const response = await fetch("https://api.deepseek.com/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        model: "deepseek-chat",
                        messages: [
                            {role: "system", content: "ä½ æ˜¯ä¸€ä¸ªåŠ æ‹¿å¤§28èµ°åŠ¿åˆ†æåŠ©æ‰‹ã€‚"},
                            {role: "user", content: prompt}
                        ],
                        temperature: 0.6,
                        max_tokens: 16
                    })
                });
                
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                let aiText = data.choices?.[0]?.message?.content?.trim() || "";
                
                for (const kw of ["å¤§å•", "å¤§åŒ", "å°å•", "å°åŒ"]) {
                    if (aiText.includes(kw)) {
                        aiText = kw;
                        break;
                    }
                }
                
                if (["å¤§å•", "å¤§åŒ", "å°å•", "å°åŒ"].includes(aiText)) {
                    aiPredictionsByIssue[nextSection] = aiText;
                }
                
                document.getElementById('aiPredict').textContent = 
                    `AI é¢„æµ‹ï¼ˆ${nextSection}ï¼‰ï¼š${aiText || 'è·å–å¤±è´¥'}`;
                
                if (["å¤§å•", "å¤§åŒ", "å°å•", "å°åŒ"].includes(aiText)) {
                    const aiDisplay = formatPredictionDisplay(aiText);
                    document.getElementById('aiPredTop').textContent = `AIé¢„æµ‹ï¼š${aiDisplay}`;
                } else {
                    document.getElementById('aiPredTop').textContent = `AIé¢„æµ‹ï¼š${aiText || 'è·å–å¤±è´¥'}`;
                }
            } catch (error) {
                console.error('AIé¢„æµ‹å¤±è´¥:', error);
                if (!auto) {
                    alert(`è°ƒç”¨ DeepSeek æ¥å£å‡ºé”™ï¼š\n${error.message}`);
                }
                document.getElementById('aiPredTop').textContent = "AIé¢„æµ‹ï¼šè·å–å¤±è´¥";
            }
        }

        // Tokenç®¡ç†
        function loadDeepSeekToken() {
            const token = localStorage.getItem('deepseek_token');
            if (token) {
                document.getElementById('tokenInput').value = token;
            }
        }

        // è”ç³»æ–¹å¼
        function showContact() {
            alert("ã€è”ç³»æ–¹å¼ã€‘\nQç¾¤ï¼š1077134386\nTelegramï¼ˆé£æœºï¼‰ï¼š@laomao12315\n\nã€å…è´£å£°æ˜ã€‘\næœ¬å·¥å…·ä»…ç”¨äºæ•°æ®å±•ç¤ºå’Œèµ°åŠ¿åˆ†æï¼Œä¸æä¾›ä»»ä½•å½¢å¼çš„æŠ•æ³¨å»ºè®®æˆ–ä¿è¯ç›ˆåˆ©ã€‚\nå½©ç¥¨ã€æ¸¸æˆç­‰å…·æœ‰é«˜é£é™©ï¼Œè¯·ç†æ€§å‚ä¸ï¼Œè‡ªè´Ÿç›ˆäºã€‚");
        }

        // ==================== å¯åŠ¨ç•Œé¢é€»è¾‘ ====================
        let splashCountdown = 5;
        let splashTimer = null;
        const AGREED_KEY = 'user_agreed_disclaimer';

        function initSplashScreen() {
            // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç»åŒæ„è¿‡
            const hasAgreed = localStorage.getItem(AGREED_KEY);
            const splashScreen = document.getElementById('splashScreen');
            const mainContent = document.getElementById('mainContentWrapper');
            
            if (hasAgreed === 'true') {
                // å·²åŒæ„ï¼Œç›´æ¥æ˜¾ç¤ºä¸»å†…å®¹
                if (splashScreen && mainContent) {
                    splashScreen.style.display = 'none';
                    mainContent.classList.add('show');
                }
                return;
            }

            // æ˜¾ç¤ºå¯åŠ¨ç•Œé¢
            if (splashScreen && mainContent) {
                splashScreen.classList.remove('hidden');
                mainContent.classList.remove('show');
                
                // å¼€å§‹å€’è®¡æ—¶
                startSplashCountdown();
            }
        }

        function startSplashCountdown() {
            const countdownNumber = document.getElementById('countdownNumber');
            const agreeButton = document.getElementById('agreeButton');
            
            if (!countdownNumber || !agreeButton) return;

            splashCountdown = 5;
            countdownNumber.textContent = splashCountdown;

            splashTimer = setInterval(() => {
                splashCountdown--;
                countdownNumber.textContent = splashCountdown;

                if (splashCountdown <= 0) {
                    clearInterval(splashTimer);
                    // å€’è®¡æ—¶ç»“æŸï¼Œå¯ç”¨æŒ‰é’®
                    agreeButton.disabled = false;
                    countdownNumber.textContent = '0';
                    countdownNumber.parentElement.innerHTML = 'âœ… å·²é˜…è¯»å®Œæˆï¼Œå¯ä»¥ç‚¹å‡»"æˆ‘åŒæ„å¹¶è¿›å…¥"æŒ‰é’®';
                }
            }, 1000);
        }

        function agreeAndEnter() {
            // ä¿å­˜ç”¨æˆ·åŒæ„çŠ¶æ€
            localStorage.setItem(AGREED_KEY, 'true');
            
            // éšè—å¯åŠ¨ç•Œé¢
            hideSplashScreen();
        }

        function hideSplashScreen() {
            const splashScreen = document.getElementById('splashScreen');
            const mainContent = document.getElementById('mainContentWrapper');
            
            if (splashScreen && mainContent) {
                // æ¸…é™¤å€’è®¡æ—¶
                if (splashTimer) {
                    clearInterval(splashTimer);
                }
                
                // æ·¡å‡ºå¯åŠ¨ç•Œé¢
                splashScreen.classList.add('hidden');
                
                // å»¶è¿Ÿæ˜¾ç¤ºä¸»å†…å®¹ï¼Œç­‰å¾…æ·¡å‡ºåŠ¨ç”»å®Œæˆ
                setTimeout(() => {
                    mainContent.classList.add('show');
                    splashScreen.style.display = 'none';
                    // åˆå§‹åŒ–ä¸»å†…å®¹
                    initMainContent();
                }, 500);
            }
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–å¯åŠ¨ç•Œé¢
        document.addEventListener('DOMContentLoaded', function() {
            initSplashScreen();
            
            // å¦‚æœç”¨æˆ·å·²ç»åŒæ„è¿‡ï¼Œç›´æ¥åˆå§‹åŒ–ä¸»å†…å®¹
            const hasAgreed = localStorage.getItem(AGREED_KEY);
            if (hasAgreed === 'true') {
                initMainContent();
            }
        });
    </script>
    </div> <!-- å…³é—­ main-content-wrapper -->
</body>
</html>
